<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Movies!</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.js"></script>

  </head>
  <body>
    Main body section
    <div id="chart"></div>

    <script type="text/javascript">
      let rawData = "";
      let rawTitles = []
      let titles = []
      let rawLinks = []
      let links = []
      let rawImageUrls = []
      let imageUrls = []
      let rawSales = []
      let sales = []
      let complete = []

      $.getJSON('http://www.whateverorigin.org/get?url=' + encodeURIComponent('http://www.imdb.com/chart/boxoffice') + '&callback=?', function(data){
	      rawData = data.contents.slice(36150, 49173);

        rawTitles = rawData.match(/ >.*?</g);
        titles = rawTitles.map(title => title.slice(2, -1))

        rawLinks = rawData.match(/href="\/title.*?"\n>/g);
        links = rawLinks.map(link => "http://www.imdb.com/" + link.slice(6, -3))

        rawImageUrls = rawData.match(/img src=".*?"/g);
        imageUrls = rawImageUrls.map(img => img.slice(8, -1) + '"');

        rawSales = rawData.match(/\$.*</g);
        sales = rawSales.map(sale  => parseFloat(sale.slice(1, -2)));

        complete = [titles, links, imageUrls, sales]

        console.log(complete);

        (function() {
          var width = 500, height = 500;

          var svg = d3.select('#chart')
            .append("svg")
            .attr('height', height)
            .attr('width', width)
            .append('g')
            .attr("transform", "translate(0,0)")

          var simulation = d3.forceSimulation()

          // d3.queue()
            // .defer(d3.)

        })();

      });

    </script>
    <!-- <script src="bubble.js"></script> -->
  </body>
</html>
